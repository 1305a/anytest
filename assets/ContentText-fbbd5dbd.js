import{A as S,B as L,C as O,d as U,D as h,e as j,G as T,H as z,I as R,J as x,r as _,o as K,b as N,w as F,f as B,g as H}from"./index-feb63d9f.js";var G=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],k=function(n){return G.map(function(t){return t.toLowerCase()}).indexOf(n.toLowerCase())!==-1},q=function(n,t,e){Object.keys(t).filter(k).forEach(function(a){var r=t[a];typeof r=="function"&&(a==="onInit"?r(n,e):e.on(a.substring(2),function(l){return r(l,e)}))})},J=function(n,t,e,a){var r=n.modelEvents?n.modelEvents:null,l=Array.isArray(r)?r.join(" "):r;S(a,function(i,o){e&&typeof i=="string"&&i!==o&&i!==e.getContent({format:n.outputFormat})&&e.setContent(i)}),e.on(l||"change input undo redo",function(){t.emit("update:modelValue",e.getContent({format:n.outputFormat}))})},W=function(n,t,e,a,r,l){a.setContent(l()),e.attrs["onUpdate:modelValue"]&&J(t,e,a,r),q(n,e.attrs,a)},D=0,w=function(n){var t=Date.now(),e=Math.floor(Math.random()*1e9);return D++,n+"_"+e+D+String(t)},$=function(n){return n!==null&&n.tagName.toLowerCase()==="textarea"},E=function(n){return typeof n>"u"||n===""?[]:Array.isArray(n)?n:n.split(" ")},Q=function(n,t){return E(n).concat(E(t))},X=function(n){return n==null},V=function(){return{listeners:[],scriptId:w("tiny-script"),scriptLoaded:!1}},Y=function(){var n=V(),t=function(r,l,i,o){var u=l.createElement("script");u.referrerPolicy="origin",u.type="application/javascript",u.id=r,u.src=i;var c=function(){u.removeEventListener("load",c),o()};u.addEventListener("load",c),l.head&&l.head.appendChild(u)},e=function(r,l,i){n.scriptLoaded?i():(n.listeners.push(i),r.getElementById(n.scriptId)||t(n.scriptId,r,l,function(){n.listeners.forEach(function(o){return o()}),n.scriptLoaded=!0}))},a=function(){n=V()};return{load:e,reinitialize:a}},Z=Y(),nn=function(){return typeof window<"u"?window:global},v=function(){var n=nn();return n&&n.tinymce?n.tinymce:null},en={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(n){return n==="html"||n==="text"}}},m=globalThis&&globalThis.__assign||function(){return m=Object.assign||function(n){for(var t,e=1,a=arguments.length;e<a;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},m.apply(this,arguments)},tn=function(n,t,e,a){return n(a||"div",{id:t,ref:e})},on=function(n,t,e){return n("textarea",{id:t,visibility:"hidden",ref:e})},an=L({props:en,setup:function(n,t){var e=n.init?m({},n.init):{},a=O(n),r=a.disabled,l=a.modelValue,i=a.tagName,o=U(null),u=null,c=n.id||w("tiny-vue"),f=n.init&&n.init.inline||n.inline,C=!!t.attrs["onUpdate:modelValue"],b=!0,A=n.initialValue?n.initialValue:"",y="",M=function(s){return C?function(){return l!=null&&l.value?l.value:""}:function(){return s?A:y}},p=function(){var s=M(b),d=m(m({},e),{readonly:n.disabled,selector:"#"+c,plugins:Q(e.plugins,n.plugins),toolbar:n.toolbar||e.toolbar,inline:f,setup:function(g){u=g,g.on("init",function(I){return W(I,n,t,g,l,s)}),typeof e.setup=="function"&&e.setup(g)}});$(o.value)&&(o.value.style.visibility=""),v().init(d),b=!1};S(r,function(s){var d;u!==null&&(typeof((d=u.mode)===null||d===void 0?void 0:d.set)=="function"?u.mode.set(s?"readonly":"design"):u.setMode(s?"readonly":"design"))}),S(i,function(s){var d;C||(y=u.getContent()),(d=v())===null||d===void 0||d.remove(u),h(function(){return p()})}),j(function(){if(v()!==null)p();else if(o.value&&o.value.ownerDocument){var s=n.cloudChannel?n.cloudChannel:"5",d=n.apiKey?n.apiKey:"no-api-key",g=X(n.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+d+"/tinymce/"+s+"/tinymce.min.js":n.tinymceScriptSrc;Z.load(o.value.ownerDocument,g,p)}}),T(function(){v()!==null&&v().remove(u)}),f||(z(function(){b||p()}),R(function(){var s;C||(y=u.getContent()),(s=v())===null||s===void 0||s.remove(u)}));var P=function(s){var d;y=u.getContent(),(d=v())===null||d===void 0||d.remove(u),e=m(m({},e),s),h(function(){return p()})};return t.expose({rerender:P}),function(){return f?tn(x,c,o,n.tagName):on(x,c,o)}}});const un={__name:"ContentText",props:["componentData"],emits:["update:componentData"],setup(n,{emit:t}){const e=n,a={menubar:!1,plugins:"lists ",toolbar:"styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | degButton | supButton | subButton | fontselect fontsizeselect forecolor",entity_encoding:"named",fontsize_formats:"8px 10px 12px 14px 18px 24px 36px",entities:"deg, sup, sub",setup:function(i){i.ui.registry.addButton("degButton",{text:"&deg",onAction:function(o){i.insertContent("&deg")}}),i.ui.registry.addButton("supButton",{text:"Верх",onAction:function(o){i.insertContent("<sup>2</sup> ")}}),i.ui.registry.addButton("subButton",{text:"Низ",onAction:function(o){i.insertContent("<sub>2</sub> ")}})}},r=i=>{console.log("ВЫЗОВ");const o=l(i);t("update:componentData",{text:o})};function l(i){var o=document.createElement("textarea");return o.innerHTML=i,o.value}return(i,o)=>{const u=_("el-input"),c=_("el-form-item");return K(),N(c,{label:"Текст:"},{default:F(()=>[B(u,{modelValue:e.componentData.text,"onUpdate:modelValue":o[0]||(o[0]=f=>e.componentData.text=f),autosize:"",type:"textarea",placeholder:"Please input"},null,8,["modelValue"]),B(H(an),{width:"100%",onInput:o[1]||(o[1]=f=>r()),init:a,"output-format":"html",modelValue:e.componentData.text,"onUpdate:modelValue":o[2]||(o[2]=f=>e.componentData.text=f),autosize:"",type:"textarea",placeholder:"Please input"},null,8,["modelValue"])]),_:1})}}};export{un as default};
